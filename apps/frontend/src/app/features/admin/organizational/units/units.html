<div class="units">
  <div class="units__header">
    <div class="header__group">
      <!-- <div class="header__title">
        <h2>Quáº£n lÃ½ Ä‘Æ¡n vá»‹</h2>
      </div> -->
      <div class="header__search">
        <input type="text" placeholder="TÃ¬m Ä‘Æ¡n vá»‹..." />
      </div>
      <div class="header__add">
        <button class="btn btn-primary" (click)="toggleUnitCreate()">
          <span class="btn-icon">+</span>
          ThÃªm Ä‘Æ¡n vá»‹
        </button>
      </div>
    </div>
    <div class="header__group header__group--block">
      <app-pagination [totalCount]="totalCount || 0" [pageOptions]="pageOptions" (pageChange)="onPageChange($event)"
        (pageSizeChange)="onPageSizeChange($event)" (orderChange)="onOrderChange($event)"></app-pagination>
    </div>
  </div>

  <div class="units__main">
    @if (units.length > 0) {
        <table class="units__table">
          <thead>
           <tr>
             <th>ID</th>
             <th>TÃªn Ä‘Æ¡n vá»‹</th>
             <th>Loáº¡i Ä‘Æ¡n vá»‹</th>
             <th>ÄÆ¡n vá»‹ cha</th>
             <th>NgÃ y thÃ nh láº­p</th>
             <th>Email</th>
             <th>Sá»‘ Ä‘iá»‡n thoáº¡i</th>
             <th>Tráº¡ng thÃ¡i</th>
             <th></th>
           </tr>
         </thead>

         <tbody>
           @for (unit of units; track unit.id) {
           <tr class="unit-row">
             <td>{{ unit.id }}</td>
             <td class="unit-name-cell">
               <div class="unit-name">{{ unit.unitName }}</div>
               <!-- <div class="unit-description">{{ unit.unitDescription || 'KhÃ´ng cÃ³ mÃ´ táº£' }}</div> -->
             </td>
             <td>{{ unit.unitType?.typeName || '-' }}</td>
             <td>{{ unit.parentUnit?.unitName || '-' }}</td>
             <td>{{ (unit.establishmentDate | date:'dd/MM/yyyy') || '-' }}</td>
             <td>{{ unit.email || '-' }}</td>
             <td>{{ unit.phone || '-' }}</td>
             <td>
               <span class="status-badge status-active">Hoáº¡t Ä‘á»™ng</span>
             </td>
             <td class="row-actions">
               <div class="actions-menu">
                 <button class="menu-button" (click)="toggleMenu(unit.id)">â‹®</button>

                 @if (selectedMenuId === unit.id) {
                 <div class="dropdown-menu" (mouseleave)="toggleMenu(unit.id)">
                   <button class="menu-item" (click)="onEditUnit(unit)">
                     <span class="btn-icon">âœï¸</span>
                     Chá»‰nh sá»­a
                   </button>
                   <button class="menu-item" (click)="onDeleteUnit(unit)">
                     <span class="btn-icon">ğŸ—‘ï¸</span>
                     XÃ³a
                   </button>
                 </div>
                 }
               </div>
             </td>
           </tr>
           }
         </tbody>
       </table>
    } @else {
    <div class="empty-state">
      <span class="empty-icon">ğŸ›ï¸</span>
      <p>ChÆ°a cÃ³ dá»¯ liá»‡u Ä‘Æ¡n vá»‹.</p>
      <button class="btn btn-primary" (click)="toggleUnitCreate()">
        <span class="btn-icon">+</span>
        ThÃªm Ä‘Æ¡n vá»‹ Ä‘áº§u tiÃªn
      </button>
    </div>
    }
  </div>
</div>

<p-confirmdialog />
<app-unit-create [isOpen]="isUnitCreateOpen" (close)="isUnitCreateOpen = false" (createdSuccessfully)="refetchUnits()"/>
@if(unitUpdateSelected){
  <app-unit-update [unit]="unitUpdateSelected" [isOpen]="isUnitUpdateOpen" (close)="onCloseUpdateForm()" (updatedSuccessfully)="refetchUnits()"/>
}

