<div class="layout">
  <aside class="layout__sidebar">
    <!-- Doanh nghiệp icon -->
    <div class="sidebar__brand">
      <img src="/icons/tdmu.png" alt="Doanh nghiệp" title="Trang chủ">
    </div>

    <!-- Menu chính -->
    <div class="sidebar__menu">
      <div class="sidebar__menu-item" routerLink="/dashboard" routerLinkActive="active">
        <img src="/icons/dashboard.svg" alt="" title="Bảng điều khiển">
        <span class="sidebar__tooltip">Bảng điều khiển</span>
      </div>
      <!-- <div class="sidebar__menu-item" routerLink="/workflow" routerLinkActive="active" (click)="refreshPendingWorkflowCount()">
        <img src="/icons/conversion_path.svg" alt="" title="Quy trình xử lý">
        <span class="sidebar__tooltip">Quy trình xử lý</span>
        @if (pendingWorkflowCount > 0) {
          <span class="notification-badge">{{ pendingWorkflowCount }}</span>
        }
      </div> -->
      <div class="sidebar__menu-item" routerLink="/document-processing" routerLinkActive="active" (click)="refreshPendingDocumentCount()">
        <img src="/icons/grading.svg" alt="" title="Xử lý văn bản">
        <span class="sidebar__tooltip">Xử lý văn bản</span>
        @if (pendingDocumentCount > 0) {
          <span class="notification-badge">{{ pendingDocumentCount }}</span>
        }
      </div>
      <div class="sidebar__menu-item" routerLink="/all-documents" routerLinkActive="active">
        <img src="/icons/attach_email.svg" alt="" title="Tất cả công văn">
        <span class="sidebar__tooltip">Tất cả công văn</span>
      </div>
      <div class="sidebar__menu-item" routerLink="/incoming-documents" routerLinkActive="active">
        <img src="/icons/incoming.svg" alt="" title="Công văn đến">
        <span class="sidebar__tooltip">Công văn đến</span>
      </div>
      <div class="sidebar__menu-item" routerLink="/outgoing-documents" routerLinkActive="active">
        <img src="/icons/outgoing.svg" alt="" title="Công văn đi">
        <span class="sidebar__tooltip">Công văn đi</span>
      </div>
      <div class="sidebar__menu-item" routerLink="/task-management" routerLinkActive="active" (click)="refreshTaskCount()">
        <img src="/icons/assignment.svg" alt="" title="Giao việc">
        <span class="sidebar__tooltip">Giao việc</span>
        @if (pendingTaskCount > 0) {
          <span class="notification-badge">{{ pendingTaskCount }}</span>
        }
      </div>
      <div class="sidebar__menu-item" routerLink="/profile" routerLinkActive="active">
        <img src="/icons/account_circle.svg" alt="" title="Quản lý Profile">
        <span class="sidebar__tooltip">Quản lý Profile</span>
      </div>
    </div>

    <!-- Cài đặt -->
    <div class="sidebar__footer">
      <div class="sidebar__menu-item" (click)="onLogout()">
        <img src="/icons/exit_to_app.svg" alt="" title="Đăng xuất">
        <span class="sidebar__tooltip">Đăng xuất</span>
      </div>
    </div>
  </aside>

  <div class="layout__main">
    <header class="header">
      <h1 class="header__title">Quản lí công văn</h1>
      <div class="header__tools">
        <button class="tool-btn" (click)="navigateToTaskManagement()" title="Giao việc mới">
          <img src="/icons/assignment.svg" alt="Giao việc">
        </button>
        <button class="tool-btn" (click)="navigateToDocumentForm()" title="Tạo văn bản mới">
          <img src="/icons/document.svg" alt="Tạo văn bản">
        </button>

        <button (click)="toggleTheme()" class="tool-btn" title="Chuyển chế độ sáng/tối">
          <img [src]="isDarkMode ? '/icons/sun.svg' : '/icons/moon.svg'" alt="Đổi giao diện">
        </button>

        <button class="tool-btn">
          <img src="/icons/calendar.svg" alt="Lịch" title="Lịch">
        </button>
        <button class="tool-btn">
          <img src="/icons/bell.svg" alt="Thông báo" title="Thông báo">
        </button>
        <button class="tool-btn" (click)="toggleAppsLauncher()">
          <img src="/icons/apps.svg" alt="Ứng dụng" title="Ứng dụng">
        </button>
        <div class="avatar">
          @if(currentUser) {
          <img class="avatar__img" [src]="currentUser.avatarFileId ? avatarUrl : '/icons/account_circle.svg'"
            [alt]="currentUser.fullName" [title]="currentUser.fullName">
          }
        </div>
      </div>
    </header>

    <main class="main-content">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>

<app-apps-launcher [isOpen]="isAppsLauncherOpen" (close)="isAppsLauncherOpen = false"></app-apps-launcher>
